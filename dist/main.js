(()=>{"use strict";const t=document.getElementById("project-todos"),e=document.getElementById("todo-creation-form"),o=()=>{let t=[];const e=localStorage.getItem("allProjects");if(null===e){const e={title:"default",todos:[],addTodo(t){this.todos.push(t)}};t.push(e),localStorage.setItem("allProjects",JSON.stringify(t))}else t=JSON.parse(e);return t},n={current:o()[0]};class d{constructor(t,e,o,n){this.title=t,this.description=e,this.priority=o,this.dueDate=n}}const r=(e,n,d)=>{t.innerHTML="",e.current.todos.forEach((i=>{const c=document.createElement("div");c.className="todo-card";const s=document.createElement("h4");s.textContent=i.title,s.className="todo-title";const u=document.createElement("p");u.textContent=i.description,u.className="todo-desc";const l=document.createElement("p");l.textContent=i.dueDate,l.className="todo-dueDate";const a=document.createElement("p");a.textContent=`${i.priority}`,a.className="todo-priority";const m=document.createElement("button");m.innerHTML="Edit",m.className="update-todo-btn",m.addEventListener("click",(()=>{document.getElementById("new-todo-creation-form").remove(),d(i,r,n)}));const p=document.createElement("button");p.innerText="delete",p.id="todo-dlt-btn",p.addEventListener("click",(()=>{const t=o(),c=t.findIndex((t=>t.title===e.current.title));e.current=t[c];const s=e.current.todos.findIndex((t=>t.title===i.title));e.current.todos.splice(s,1),localStorage.setItem("allProjects",JSON.stringify(t)),r(e,n,d)})),c.append(s,u,a,l,m,p),t.append(c)}))},i=(t,r)=>{const c=document.createElement("form");c.id="new-todo-creation-form";const s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("required","true"),s.setAttribute("placeholder","todo title"),s.id="todo-title";const u=document.createElement("input");u.setAttribute("type","text"),u.setAttribute("required","true"),u.setAttribute("placeholder","some description.."),u.id="todo-desc";const l=document.createElement("input");l.setAttribute("type","date"),l.setAttribute("required","true"),l.setAttribute("placeholder","due date"),l.id="todo-priority";const a=document.createElement("select");a.setAttribute("id","priority"),a.id="todo-dueDate";const m=["Very high","High","Moderate","Low","Useless"].map((t=>`<option value="${t.toLowerCase()}">${t}</option>`));a.innerHTML=m;const p=document.createElement("input");return p.setAttribute("type","submit"),p.id="todo-form-submit",c.append(s,u,l,a,p),e.innerHTML="",e.append(c),c.addEventListener("submit",(e=>{e.preventDefault();const c=document.getElementById("todo-title").value,s=document.getElementById("todo-desc").value,u=document.getElementById("todo-priority").value,l=document.getElementById("todo-dueDate").value,a=new d(c,s,u,l),m=o(),p=m.findIndex((t=>t.title===n.current.title));n.current=m[p],n.current.todos.push(a),localStorage.setItem("allProjects",JSON.stringify(m)),t(n,i,r)})),c},c=(t,d,r)=>{const i=document.createElement("form");i.id="modify-todo-form";const s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("required","true"),s.setAttribute("placeholder","todo title"),s.id="todo-title-modify";const u=document.createElement("input");u.setAttribute("type","text"),u.setAttribute("required","true"),u.setAttribute("placeholder","some description.."),u.id="todo-desc-modify";const l=document.createElement("input");l.setAttribute("type","date"),l.setAttribute("required","true"),l.setAttribute("placeholder","due date"),l.id="todo-priority-modify";const a=document.createElement("select");a.setAttribute("id","priority"),a.id="todo-dueDate-modify";const m=["Very high","High","Moderate","Low","Useless"].map((t=>`<option value="${t.toLowerCase()}">${t}</option>`));a.innerHTML=m;const p=document.createElement("input");return p.value="Update Todo",p.setAttribute("type","submit"),p.id="todo-form-submit-modify",i.append(s,u,l,a,p),e.append(i),i.addEventListener("submit",(e=>{e.preventDefault();const i=o(),s=i.findIndex((t=>t.title===n.current.title));n.current=i[s];const u=n.current.todos.findIndex((e=>e.title===t.title)),l=n.current.todos[u];l.title=document.getElementById("todo-title-modify").value,l.description=document.getElementById("todo-desc-modify").value,l.priority=document.getElementById("todo-priority-modify").value,l.dueDate=document.getElementById("todo-dueDate-modify").value,localStorage.setItem("allProjects",JSON.stringify(i)),d(n,r,c),document.getElementById("modify-todo-form").remove(),r(d)})),i};class s{constructor(t){this.title=t,this.todos=[]}addTodo=t=>{this.todos.push(t)}}const u=()=>{const e=document.getElementById("all-projects"),d=o();e.innerHTML="",d.forEach(((d,s)=>{const u=((e,d)=>{const s=document.createElement("a");return s.id="project-div",s.textContent=e.title,s.dataset.index=d,s.addEventListener("click",(e=>{((e,d)=>{const i=e.target,s=Number(i.dataset.index),u=o();n.current=u[s],t.innerHTML="",r(n,d,c),d(r)})(e,i)})),s})(d,s);e.append(u)}))};document.getElementById("input-form").addEventListener("submit",(t=>{t.preventDefault();const e=document.getElementById("title").value;(t=>o().find((e=>e.title===t)))(e)?alert("Project name already taken!"):((t=>{const e=o();e.push(t),localStorage.setItem("allProjects",JSON.stringify(e))})(new s(e)),u())})),document.addEventListener("DOMContentLoaded",(()=>{u()}))})();